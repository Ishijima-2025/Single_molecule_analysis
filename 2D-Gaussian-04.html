<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>successive_reaction</title>
<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">
</script>




<link href="160324.css" rel="stylesheet" type="text/css" />
<style type="text/css">
.style7 {color: #000000; }
</style>
</head>

<body>
<p class="X-Large-Bold-RED">2次元ガウシアン画像のフィッティング方法-04</p>
<p class="Large-Bold-Red">二次元　→　一次元方式におけるピーク値の求め方</p>
<p class="Large-Bold-Red">&nbsp;</p>
<p>二次元ガウシアンフィッティング方法についていろいろと調べていると，<a href="https://forums.ni.com/t5/LabVIEW/2d-Gaussian-Fit-Problem/td-p/2043600/page/2?profile.language=ja" target="_blank">ここ</a>，に実際のプログラムがアップされていました．</p>
<p>しかも回転している画像もきちんと角度まで推定できています．</p>
<p>プログラムの中身を見ると，</p>
<p><img src="2D-Gaussian-08.png" width="583" height="201" alt=""/></p>
<p>このようなデータがあり，どうも調べてみると，元画像である，2次元情報を1次元に並べ替えているようでした．</p>
<p>つまり，</p>
<table width="200" border="1">
  <tbody>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <td>7</td>
      <td>8</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
<p>という画像を，</p>
<table width="200" border="1">
  <tbody>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
      <td>8</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
<p>のように並べ替えているようでした．</p>
<p>この規則性は， <br />
　N×Nの2次元画像なら，Nごとの周期関数となる<br />
　このピークをつなげたカーブがY方向の強度分布となる<br />
と言うことになります．（X方向にスキャンしてY方向の強度分布が得られることに注意）． </p>
<p>Nごとの周期となるので，周期ごとにデータを取り出し，総和が最大となるパターンを採用すればいいことになります．</p>
<p>例えば，Y方向の場合は，2，5，8，のように．</p>
<p>これを1次元ガウス関数でフィットすれば，Y方向の情報が分かります． </p>
<p>X方向の場合には，</p>
<table width="200" border="1">
  <tbody>
    <tr>
      <td>1</td>
      <td>4</td>
      <td>7</td>
      <td>2</td>
      <td>5</td>
      <td>8</td>
      <td>3</td>
      <td>6</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
<p>のように並び替えて同様の計算を行えばいいことになります．</p>
<p>実際の様子</p>
<p>初期データとして，</p>
<p><img src="2D-Gaussian-09.png" width="355" height="343" alt=""/></p>
<p>というデータを作成しました．</p>
<table width="200" border="1">
  <tbody>
    <tr>
      <td>A0</td>
      <td>100</td>
    </tr>
    <tr>
      <td>y0</td>
      <td>25</td>
    </tr>
    <tr>
      <td>dy</td>
      <td>3</td>
    </tr>
    <tr>
      <td>x0</td>
      <td>25</td>
    </tr>
    <tr>
      <td>dx</td>
      <td>4</td>
    </tr>
    <tr>
      <td>Base</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Noise</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
<p>このデータを1次元に並び替えると，</p>
<p><img src="2D-Gaussian-08.png" width="583" height="201" alt=""/></p>
<p>のようになります．N=50，なので，総和が一番大きくなる配列を取り出すと，</p>
<p><img src="2D-Gaussian-10.png" width="632" height="200" alt=""/></p>
<p>と1次元のガウスフィットが可能となります（Yスキャン）．</p>
<p>結果は，</p>
<table width="260" border="1">
  <tbody>
    <tr>
      <td width="98">&nbsp;</td>
      <td width="63">初期値</td>
      <td width="77">フィット</td>
    </tr>
    <tr>
      <td>A0y</td>
      <td>100</td>
      <td>93.96</td>
    </tr>
    <tr>
      <td>y0</td>
      <td>25</td>
      <td>25.05</td>
    </tr>
    <tr>
      <td>dy</td>
      <td>3</td>
      <td>3.10</td>
    </tr>
    <tr>
      <td>Base_y</td>
      <td>10</td>
      <td>10.41</td>
    </tr>
    <tr>
      <td>A0x</td>
      <td>100</td>
      <td>102.74</td>
    </tr>
    <tr>
      <td>x0</td>
      <td>25</td>
      <td>24.90</td>
    </tr>
    <tr>
      <td>dx</td>
      <td>4</td>
      <td>3.73</td>
    </tr>
    <tr>
      <td>Base_x</td>
      <td>10</td>
      <td>11.01</td>
    </tr>
    <tr>
      <td>Noise</td>
      <td>10</td>
      <td>&nbsp;</td>
    </tr>
  </tbody>
</table>
<p>となり，きちんとフィットしてくれていることが分かります．</p>
<p>&nbsp;</p>
<p>では，これら二つのフィット方法，どちらがよいのでしょうか？</p>
<p>次のページで議論したいと思います．</p>
<p>&nbsp;</p>
<p><span class="style7"><a href="2D-Gaussian-03.html"><img src="L-arrow.png" alt="l" width="57" height="34" border="0" /></a><a href="index.html"><img src="TOP.png" alt="t" width="57" height="34" /></a></span><a href="2D-Gaussian-05.html"><img src="R-arrow.png" alt="r" width="57" height="34" /></a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
</body>
</html>
