<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>successive_reaction</title>
<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">
</script>




<link href="160324.css" rel="stylesheet" type="text/css" />
<style type="text/css">
.style7 {color: #000000; }
</style>
</head>

<body>
<p class="X-Large-Bold-RED">2次元ガウシアン画像のフィッティング方法-02</p>
<p class="Large-Bold-Red">加算による2次元ガウシアン画像</p>
<p class="Large-Bold-Red">&nbsp;</p>
<p>これは，現在石島研で使用されているアルゴリズムで，東北大学時代に当時助教だった井上さんが作られたものです．</p>
<p><img src="2D-Gaussian-04.png" width="343" height="341" alt=""/></p>
<p>このような画像の場合，ｘ，もしくはｙ方向に加算していく手法です．</p>
<table width="200" border="1">
  <tbody>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <td>7</td>
      <td>8</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
<p>のように，番号をつけた3×3の画像があるとします（単なる番号であって強度ではありません）．</p>
<p><span class="Blue-Bold">X方向</span>の場合は，これを，</p>
<table width="200" border="1">
  <tbody>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
<p>　　　　　 +</p>
<table width="200" border="1">
  <tbody>
    <tr>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
	  
  </tbody>
</table>
<p>　　　　　 +</p>
<table width="200" border="1">
  <tbody>
    <tr>
      <td>7</td>
      <td>8</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
<p>としていくわけです．</p>
<p><img src="2D-Gaussian-03.png" width="307" height="245" alt=""/></p>
<p>各行はこんな感じとなります（見やすくするため，ノイズは0としてあります）．</p>
<p>これを加算して1次元のガウスフィットをするわけです．</p>
<p><span class="Blue-Bold">Y方向</span>の場合は，</p>
<table width="200" border="1">
  <tbody>
    <tr>
      <td>1</td>
      <td>&nbsp;</td>
      <td>2</td>
      <td>&nbsp;</td>
      <td>3</td>
    </tr>
    <tr>
      <td>4</td>
      <td>+</td>
      <td>5</td>
      <td>+</td>
      <td>6</td>
    </tr>
    <tr>
      <td>7</td>
      <td>&nbsp;</td>
      <td>8</td>
      <td>&nbsp;</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
　
<p>のように列ごとに加算していくわけです．</p>
<p>こうすれば，おのおの一次元データとなりますので，一次元ガウスフィットを行えば，6つのパラメータが求まります．</p>
<p><img src="2D-Gaussian-05.png" width="668" height="452" alt=""/></p>
<p>ちなみに，解析結果は，</p>
<table width="335" border="1">
  <tbody>
    <tr>
      <td width="85">係数</td>
      <td width="88">初期設定</td>
      <td width="140">フィッティング</td>
    </tr>
    <tr>
      <td>A0</td>
      <td>10</td>
      <td>46.63</td>
    </tr>
    <tr>
      <td>y0</td>
      <td>10</td>
      <td>9.90</td>
    </tr>
    <tr>
      <td>dy</td>
      <td>2</td>
      <td>2.13</td>
    </tr>
    <tr>
      <td>x0</td>
      <td>15</td>
      <td>15.00</td>
    </tr>
    <tr>
      <td>dx</td>
      <td>2</td>
      <td>1.95</td>
    </tr>
    <tr>
      <td>Base</td>
      <td>2</td>
      <td>59.82</td>
    </tr>
    <tr>
      <td>Noize</td>
      <td>1</td>
      <td>&nbsp;</td>
    </tr>
  </tbody>
</table>
<p>となります．よくフィットできていることが分かります．</p>
<p>しかし，ピーク値，ベース値が初期設定と異なる値となっていることが分かります．</p>
<p>それは，各ピクセルを加算しているからですね，ではどのようにピーク値を推定したらよいでしょう？</p>
<p>次のページに示します．</p>
<p>&nbsp;</p>
<p><span class="style7"><a href="2D-Gaussian-01.html"><img src="L-arrow.png" alt="l" width="57" height="34" border="0" /></a><a href="index.html"><img src="TOP.png" alt="t" width="57" height="34" /></a></span><a href="2D-Gaussian-03.html"><img src="R-arrow.png" alt="r" width="57" height="34" /></a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
</body>
</html>
