<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>successive_reaction</title>
<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">
</script>




<link href="160324.css" rel="stylesheet" type="text/css" />
<style type="text/css">
.style7 {color: #000000; }
</style>
</head>

<body>
<p class="X-Large-Bold-RED">2次元ガウシアン画像のフィッティング方法-03</p>
<p class="Large-Bold-Red">加算におけるピーク値の求め方</p>
<p class="Large-Bold-Red">&nbsp;</p>
<p>加算像からピーク値を求める前に，まず正規分布のおさらいから始めます．</p>
<p>一次元正規分布は，</p>
<p>\( \Large  P(x)= \frac{1}{\sqrt{2 \pi} \sigma^2} Exp \left( - \frac{x^2}{2 \sigma_x^2} \right)  \)</p>
<p>となります（簡単のため，x0=0，Base=0, としてあります）．</p>
<p>規格化してあるので，</p>
<p>\( \Large  P(x)= \displaystyle \int_{- \infty}^{\infty} \frac{1}{\sqrt{2 \pi} \sigma} Exp \left( - \frac{x^2}{2 \sigma_x^2} \right) dx =1 \)</p>
<p>となります．</p>
<p>今回，フィットした関数は，</p>
<p>\( \Large   A_0 Exp \left( - \frac{x^2}{2 \sigma_x^2} \right)  \)</p>
<p>です．</p>
<p>&nbsp;</p>
<p>さて，今回フィットした値でのピーク値は，実は，以下の図の赤点の加算値となります．</p>
<p><img src="2D-Gaussian-06.png" width="591" height="310" alt=""/></p>
<p>つまり，<br />
　<span class="Large-Bold-Red">X</span>の加算像なら，<span class="Large-Bold-Blue">Y</span>の分布の積分値<br />
　<span class="Large-Bold-Blue">Y</span>の加算像なら，<span class="Large-Bold-Red">X</span>の分布の積分値<br />
となるわけです．つまり，</p>
<p>\( \Large  Peak Value = \displaystyle \int_{- \infty}^{\infty}  A_{0x} Exp \left( - \frac{y^2}{2 \sigma_y^2} \right) dy \)</p>
<p>となります．したがって，</p>
<p>\( \Large  \begin{eqnarray} \displaystyle \int_{- \infty}^{\infty}  A_{0x} Exp \left( - \frac{y^2}{2 \sigma_y^2} \right) dy<br />
  &amp;=&amp; A_{0x} \sqrt{2 \pi} \sigma_y \int_{- \infty}^{\infty}   \frac{1}{\sqrt{2 \pi} \sigma_y^2} Exp \left( - \frac{y^2}{2 \sigma_y^2} \right) dy \\<br />
  &amp;=&amp; A_{0x} \sqrt{2 \pi} \sigma_y \\ <br />
  \end{eqnarray}　\)</p>
<p>となりますので，</p>
<p>\( \Large  \displaystyle A_{0x} = \frac{1}{\sqrt{2 \pi}}\frac{Peak Value_x}{ \sigma_y} \)</p>
<p>となります．</p>
<p>\( \Large  \sqrt{2 \pi} \simeq 2.5 \)</p>
<p>なので，大体，<span class="Large-Bold-Red">2/5</span>，倍となります．</p>
<p>注意すべき点は，</p>
<p>　XとYとをたすき掛けにして割る</p>
<p>ことです．</p>
<p>実際に確かめてみましょう．XYの偏差を異なる値で作ってみました．</p>
<p><img src="2D-Gaussian-07.png" width="353" height="340" alt=""/></p>
<p>&nbsp;</p>
<p>書記パラメータ，解析結果は，</p>
<table width="335" border="1">
  <tbody>
    <tr>
      <td width="85">係数</td>
      <td width="88">初期設定</td>
      <td width="140">フィッティング</td>
    </tr>
    <tr>
      <td>A0y</td>
      <td>1</td>
      <td>10.13</td>
    </tr>
    <tr>
      <td>y0</td>
      <td>20</td>
      <td>20.01</td>
    </tr>
    <tr>
      <td>dy</td>
      <td>2</td>
      <td>1.96</td>
    </tr>
    <tr>
      <td>Base_x</td>
      <td>0</td>
      <td>0.09</td>
    </tr>
    <tr>
      <td>A0x</td>
      <td>1</td>
      <td>5.33</td>
    </tr>
    <tr>
      <td>x0</td>
      <td>15</td>
      <td>14.99</td>
    </tr>
    <tr>
      <td>dx</td>
      <td>4</td>
      <td>3.82</td>
    </tr>
    <tr>
      <td>Base_y</td>
      <td>0</td>
      <td>0.04</td>
    </tr>
    <tr>
      <td>Noize</td>
      <td>0.1</td>
      <td>&nbsp;</td>
    </tr>
  </tbody>
</table>
<p>となり，XとYとでピークの値が異なることが分かります．</p>
<p>上の計算を行ってみると，</p>
<p>\( \Large  \displaystyle A_{0x} = \frac{1}{\sqrt{2 \pi}}\frac{5.33}{ 1.96}=1.08 \)</p>
<p>\( \Large  \displaystyle A_{0y} = \frac{1}{\sqrt{2 \pi}}\frac{10.13}{3.82}=1.06 \)</p>
<p>と初期値である1とよく一致していることが分かります．</p>
<p>このように，一見単純で雑なように見える加算方式ですが，きちんと元データを繁栄していることが分かります．</p>
<p>&nbsp;</p>
<p>次のページに，新しい（？）フィッティング方法について示します．</p>
<p>&nbsp;</p>
<p><span class="style7"><a href="2D-Gaussian-02.html"><img src="L-arrow.png" alt="l" width="57" height="34" border="0" /></a><a href="index.html"><img src="TOP.png" alt="t" width="57" height="34" /></a></span><a href="2D-Gaussian-04.html"><img src="R-arrow.png" alt="r" width="57" height="34" /></a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
</body>
</html>
